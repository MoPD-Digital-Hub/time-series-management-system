{% extends 'base/base.html' %}
{% load static %}
{% block content %}
    {% include 'base/common/head.html' %}
    {% include 'base/common/nav.html' %}
    {% include 'base/common/header.html' %}
   <div class="pc-container">
  <div class="pc-content">
    <div class="container mx-auto py-6">
      <h2 class="text-2xl font-bold mb-4">All Topics</h2>

      <!-- Search Input -->
      <div class="mb-4">
        <input type="text" id="searchTopics" placeholder="Search topics..."
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
      </div>

      <div class="table-responsive">
        <table id="topicsTable" class="table table-striped table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th scope="col" style="width:56px">#</th>
              <th scope="col">Title (English)</th>
              <th scope="col">Title (Amharic)</th>
              <th scope="col">Categories</th>
            </tr>
          </thead>
          <tbody>
            {% for topic in topics %}
            <tr>
              <td class="text-muted">{{ forloop.counter }}</td>
              <td class="fw-semibold">{{ topic.title_ENG }}</td>
              <td>{{ topic.title_AMH }}</td>
              <td><span class="badge bg-primary-subtle text-primary">{{ topic.categories.count }}</span></td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const searchInput = document.getElementById("searchTopics");
      const table = document.getElementById("topicsTable");
      const tbody = table.querySelector("tbody");
      const rows = Array.from(tbody.querySelectorAll("tr"));

      searchInput.addEventListener("input", function () {
        const query = this.value.trim().toLowerCase();
        let found = false;

        rows.forEach(row => {
          const english = row.cells[1]?.textContent.toLowerCase() || "";
          const amharic = row.cells[2]?.textContent.toLowerCase() || "";
          if (english.includes(query) || amharic.includes(query)) {
            row.style.display = "";
            found = true;
          } else {
            row.style.display = "none";
          }
        });
        let noRow = tbody.querySelector(".no-result");
        if (!found) {
          if (!noRow) {
            noRow = document.createElement("tr");
            noRow.classList.add("no-result");
            noRow.innerHTML = `<td colspan="4" class="px-4 py-2 text-center text-gray-500">No topic found.</td>`;
            tbody.appendChild(noRow);
          }
        } else {
          if (noRow) noRow.remove();
        }
      });
    });
  </script>
    {% include 'base/common/footer.html' %}
    {% include 'base/common/js.html' %}
{% endblock %}
